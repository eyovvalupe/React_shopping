{"ast":null,"code":"import _objectSpread from \"/Users/jared/workspace/github/jaredpalmer/react-suspense/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar token;\nexport function getToken() {\n  return localStorage.getItem('spotify-token');\n}\nexport var setToken = function setToken(t) {\n  token = t;\n  localStorage.setItem('spotify-token', t);\n};\nexport var sleep = function sleep(ms) {\n  return new Promise(function (r) {\n    return setTimeout(r, ms);\n  });\n}; // Authenticated fetch wrapper\n\nexport var fetch = function fetch(url, options) {\n  var t = token || localStorage.getItem('spotify-token');\n  return window.fetch(url, _objectSpread({\n    headers: {\n      Authorization: \"Bearer \".concat(t)\n    }\n  }, options)).then(function (res) {\n    if (res.status === 401) {\n      token = undefined;\n      localStorage.removeItem('spotify-token');\n    }\n\n    return res;\n  });\n};","map":{"version":3,"sources":["/Users/jared/workspace/github/jaredpalmer/react-suspense/src/api/auth.js"],"names":["token","getToken","localStorage","getItem","setToken","t","setItem","sleep","ms","Promise","r","setTimeout","fetch","url","options","window","headers","Authorization","then","res","status","undefined","removeItem"],"mappings":";AAAA,IAAIA,KAAJ;AAEA,OAAO,SAASC,QAAT,GAAoB;AACzB,SAAOC,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAP;AACD;AAED,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,CAAC,EAAI;AAC3BL,EAAAA,KAAK,GAAGK,CAAR;AACAH,EAAAA,YAAY,CAACI,OAAb,CAAqB,eAArB,EAAsCD,CAAtC;AACD,CAHM;AAKP,OAAO,IAAME,KAAK,GAAG,SAARA,KAAQ,CAAAC,EAAE;AAAA,SAAI,IAAIC,OAAJ,CAAY,UAAAC,CAAC;AAAA,WAAIC,UAAU,CAACD,CAAD,EAAIF,EAAJ,CAAd;AAAA,GAAb,CAAJ;AAAA,CAAhB,C,CAEP;;AACA,OAAO,IAAMI,KAAK,GAAG,SAARA,KAAQ,CAACC,GAAD,EAAMC,OAAN,EAAkB;AACrC,MAAMT,CAAC,GAAGL,KAAK,IAAIE,YAAY,CAACC,OAAb,CAAqB,eAArB,CAAnB;AACA,SAAOY,MAAM,CACVH,KADI,CACEC,GADF;AAEHG,IAAAA,OAAO,EAAE;AACPC,MAAAA,aAAa,mBAAYZ,CAAZ;AADN;AAFN,KAKAS,OALA,GAOJI,IAPI,CAOC,UAAAC,GAAG,EAAI;AACX,QAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACtBpB,MAAAA,KAAK,GAAGqB,SAAR;AACAnB,MAAAA,YAAY,CAACoB,UAAb,CAAwB,eAAxB;AACD;;AACD,WAAOH,GAAP;AACD,GAbI,CAAP;AAcD,CAhBM","sourcesContent":["let token;\n\nexport function getToken() {\n  return localStorage.getItem('spotify-token');\n}\n\nexport const setToken = t => {\n  token = t;\n  localStorage.setItem('spotify-token', t);\n};\n\nexport const sleep = ms => new Promise(r => setTimeout(r, ms));\n\n// Authenticated fetch wrapper\nexport const fetch = (url, options) => {\n  const t = token || localStorage.getItem('spotify-token');\n  return window\n    .fetch(url, {\n      headers: {\n        Authorization: `Bearer ${t}`,\n      },\n      ...options,\n    })\n    .then(res => {\n      if (res.status === 401) {\n        token = undefined;\n        localStorage.removeItem('spotify-token');\n      }\n      return res;\n    });\n};\n"]},"metadata":{},"sourceType":"module"}